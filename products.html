<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Products | PriceTrackr</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="dashboard-page">

    <header class="dashboard-header">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <h4 class="logo">PriceTrackr</h4>
            {% if user %}<div class="user-info"><span>{{ user['name'] }}</span><img src="{{ user['profile_pic'] }}" alt="Profile Picture" class="profile-pic"><a href="{{ url_for('logout') }}" class="btn btn-sm btn-logout">Logout</a></div>{% endif %}
        </div>
    </header>

    <main class="container-fluid mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}{% if messages %}<div class="row justify-content-center"><div class="col-lg-8">{% for category, message in messages %}<div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">{{ message }}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>{% endfor %}</div></div>{% endif %}{% endwith %}

        <div class="dashboard-controls">
            <a href="{{ url_for('home') }}" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Add Product</a>
            <h2>Your Tracked Products</h2>
        </div>
        
        <div class="product-grid">
            {% if products %}
                {% for product in products %}
                <div class="product-card">
                    <div class="product-card-img-container">
                        <img src="{{ product['image_url'] }}" class="product-img" alt="{{ product['name'] }}">
                    </div>
                    <div class="product-card-body">
                        <h5 class="product-name">{{ product['name'] }}</h5>
                        <p class="product-url"><a href="{{ product['url'] }}" target="_blank">View on Store</a></p>
                    </div>
                    <div class="product-card-footer">
                        <span class="target-price">Target: <strong>â‚¹{{ product['target_price'] }}</strong></span>
                        <div class="product-actions">
                            <a href="{{ url_for('edit_product', product_id=product['id']) }}" class="btn-edit" title="Edit item"><i class="fas fa-pen"></i></a>
                            <form action="{{ url_for('delete') }}" method="POST" class="d-inline">
                                <input type="hidden" name="product_id" value="{{ product['id'] }}">
                                <button type="submit" class="btn-delete" title="Delete item"><i class="fas fa-trash-alt"></i></button>
                            </form>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="col-12 text-center p-5 empty-state">
                    <i class="fas fa-box-open fa-3x mb-3"></i>
                    <h4>Your tracking list is empty.</h4>
                    <p><a href="{{ url_for('home') }}">Add a product</a> to get started.</p>
                </div>
            {% endif %}
        </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>