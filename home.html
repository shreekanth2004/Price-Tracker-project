<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home | PriceTrackr</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="dashboard-page">

    <header class="dashboard-header">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <h4 class="logo">PriceTrackr</h4>
            {% if user %}
            <div class="user-info">
                <span>{{ user['name'] }}</span>
                <img src="{{ user['profile_pic'] }}" alt="Profile Picture" class="profile-pic">
                <a href="/logout" class="btn btn-sm btn-logout">Logout</a>
            </div>
            {% endif %}
        </div>
    </header>

    <main class="container mt-4">
        
        <div class="row stats-bar">
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="stat-icon icon-products"><i class="fas fa-tags"></i></div>
                    <div class="stat-info">
                        <h5>Products Tracked</h5>
                        <p>{{ product_count }}</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="stat-icon icon-alerts"><i class="fas fa-bell"></i></div>
                    <div class="stat-info">
                        <h5>Alerts Received</h5>
                        <p>0</p> </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="stat-icon icon-savings"><i class="fas fa-piggy-bank"></i></div>
                    <div class="stat-info">
                        <h5>Potential Savings</h5>
                        <p>â‚¹0</p> </div>
                </div>
            </div>
        </div>

        <div class="row justify-content-center mt-4">
            <div class="col-lg-7">
                <div class="form-card">
                     <div class="add-product-card-header">
                        <div class="header-icon"><i class="fas fa-plus"></i></div>
                        <h3>Track a New Product</h3>
                    </div>
                    <div class="add-product-card-body">
                        <form action="/track" method="POST" id="track-form">
                            <div class="form-group">
                                <label for="product_url">Product URL</label>
                                <input type="url" class="form-control" id="product_url" name="product_url" placeholder="https://www.amazon.in/dp/..." required>
                            </div>
                            <div class="form-group">
                                <label for="target_price">Target Price (â‚¹)</label>
                                <input type="number" step="0.01" class="form-control" id="target_price" name="target_price" placeholder="e.g., 49999" required>
                            </div>
                            <button type="submit" class="btn-submit" id="track-button">
                                <span class="button-text">Add to Tracker</span>
                                <i class="fas fa-spinner fa-spin button-loader d-none"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="row text-center mt-5">
             <div class="col-12">
                <h4 class="section-title">Why Use PriceTrackr?</h4>
            </div>
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-store"></i></div>
                    <h5>Multi-Store Support</h5>
                    <p>Track products from Amazon, with more stores like Flipkart and Myntra coming soon.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-envelope-open-text"></i></div>
                    <h5>Instant Email Alerts</h5>
                    <p>Get notified the moment your product's price drops, so you never miss a deal.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-infinity"></i></div>
                    <h5>Unlimited Tracking</h5>
                    <p>Monitor as many products as you want, all in one simple and clean dashboard.</p>
                </div>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-lg-8">
                <div class="chart-card">
                    <h5 class="card-title-light">See Price Volatility in Action</h5>
                    <p class="text-muted">Prices change frequently. Our tracker helps you buy at the perfect moment.</p>
                    <div class="sample-chart">
                        <svg width="100%" height="150" viewBox="0 0 500 150" preserveAspectRatio="none">
                            <path d="M 0 80 C 50 40, 100 120, 150 90 S 250 20, 300 60 S 400 130, 450 100 L 500 80" fill="none" stroke="var(--primary-color)" stroke-width="3"/>
                            <circle cx="150" cy="90" r="5" fill="var(--primary-color)"/>
                            <circle cx="275" cy="40" r="5" fill="#34d399"/>
                        </svg>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="tip-card">
                     <h5 class="card-title-light">ðŸ’¡ Quick Tip</h5>
                     <p>Major sales events like Prime Day or Diwali sales are the best times to snag a deal. Add products to your tracker beforehand to get notified instantly when the sale starts!</p>
                </div>
            </div>
        </div>
        
        {% if popular_products %}
        <div class="row justify-content-center mt-5">
            <div class="col-12 text-center">
                <h4 class="section-title">Trending Products</h4>
            </div>
            <div class="col-lg-10">
                <div class="product-grid">
                    {% for product in popular_products %}
                    <div class="product-card">
                        <div class="product-card-img-container">
                            <img src="{{ product['image_url'] }}" class="product-img" alt="{{ product['name'] }}">
                        </div>
                        <div class="product-card-body">
                            <h5 class="product-name">{{ product['name'] }}</h5>
                        </div>
                        <div class="product-card-footer">
                           <span class="target-price">Trending Item</span>
                           <a href="{{ product['url'] }}" target="_blank" class="btn-edit" title="View Item"><i class="fas fa-eye"></i></a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}

        {% if recent_products %}
        <div class="row justify-content-center mt-5">
            <div class="col-12 text-center">
                <h4 class="section-title">Your Recently Added Products</h4>
            </div>
            <div class="col-lg-10">
                <div class="product-grid">
                    {% for product in recent_products %}
                    <div class="product-card">
                        <div class="product-card-img-container">
                            <img src="{{ product['image_url'] }}" class="product-img" alt="{{ product['name'] }}">
                        </div>
                        <div class="product-card-body">
                            <h5 class="product-name">{{ product['name'] }}</h5>
                        </div>
                        <div class="product-card-footer">
                            <span class="target-price">Target: <strong>â‚¹{{ product['target_price'] }}</strong></span>
                            <a href="{{ url_for('products') }}" class="btn-edit" title="Edit/Delete"><i class="fas fa-pen"></i></a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
             <div class="text-center mt-4">
                <a href="{{ url_for('products') }}" class="btn-view-all">
                    View All Your Tracked Products <i class="fas fa-arrow-right ms-2"></i>
                </a>
            </div>
        </div>
        {% endif %}

    </main>

    <footer class="text-center py-4 mt-4">
        <p>&copy; 2025 PriceTrackr. All Rights Reserved.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>